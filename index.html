<!-- Avvio di video al riconoscimento di un target immagine.
 
PASSAGGI DA SEGUIRE
 1. IMAGE TARGETS COMPILER: creare il file per il riconoscimento dei target, attraverso questo link(https://hiukim.github.io/mind-ar-js-doc/tools/compile/).
	Il file dev'essere inserito all'interno della sotto-cartella "data", situata nella cartella di progetto.
	1.1 Carica una o più immagini, nell'ordine desiderato.
	1.2 Clicca "Start" e attendi il completamento dell'operazione.
	1.3 Clicca "Download compiler"; verrà scaricato il file "targets.mind", da sostituire a quello presente nella cartella "data".
 2. VIDEO: caricare i video corrispondenti ai diversi target nella sotto-cartella "data". Rinominarli in ordine "video1.mp4", "video2.mp4",... . 
 3. MODIFICARE CODICE (qui segnato in ordine di come è scritto il file).
	3.1 Modificare stile bottone di avvio video
		<style> #startButton: per modificarne gli aspetti visivi e/o posizione.
		<body> <button>: per modificare il testo.
	3.2 Sistemare i TARGET
		Duplicare le linee di codice corrispondenti a quanti target ci sono. 
		<a-entity> mindar-image-target="targetIndex": deve corrispondere al numero del target -1. il primo ha targetIndex = 0, il secondo ha targetIndex = 1,... . 
		<a-video> id="videonElement" //src="#videon" : n corrisponde al numero del target. il terzo target avrà quindi id="video3Element" e src="#video3".
		width="1" height="0.5625": da regolare in base all'aspect ratio del video da riprodurre. 
	3.3 Sistemare i VIDEO OUTPUT
		Duplicare e avere il numero di elementi in base al numero di video necessari.
		Sistemare corrispettivamente gli id e la src corrispondente.
	3.4 Modificare lo script in base al numero di elementi corrispondenti.
		const targetMap: inserire gli id degli elementi video in ordine e separandoli con una virgola.
		[0, 1]: modifica la lista tra parentesi quadre inserendo i target index dei TARGET. se ci sono 3 TARGET da riconoscere, la lista sarà [0, 1, 2] (inizia da 0).

ANTEPRIMA DA VSCODE A MOBILE
Cliccando "Go Live", è possibile avere un'anteprima in locale sul brower. Al suo posto, appare il numero di una porta (ad es. Port: 5500).
Per visualizzarlo su mobile, sono necessari l'indirizzo IP dal tuo pc sul quale si trova il codice che avvii e questo numero di porta.
Da mobile, entrare in una nuova pagina del browser e digitare indirizzoIP:numero porta (ad es. 123.456.7.89:5500).

-->


<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- titolo della pagina web -->
    <title>esempio con più target e partenza video</title>

    <!-- librerie A-Frame, MindAR -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.3/dist/mindar-image-aframe.prod.js"></script>

    <!-- stile della pagina web -->
    <style>
      body {
        background: #000;
        -webkit-user-select: none; /* Safari */
        -ms-user-select: none; /* IE 10 and IE 11 */
        user-select: none; /* Standard syntax */
        margin: 0;
        overflow: hidden;
        font-family: 'Arial', sans-serif;
      }

      #infoButton {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 10;
        padding: 10px;
        background-color: transparent;
        border: none;
        cursor: pointer;
      }

      #loadingScreen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: #000;
        color: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        z-index: 100;
        font-weight: bold;
      }

      #countdown {
        font-size: 2em;
        margin-top: 20px;
      }

      #infoImage, #endImage {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100;
      }

      #infoImage img, #endImage img {
        max-width: 80%;
        max-height: 80%;
      }
    </style>
  </head>

  <body>
    <div id="loadingScreen">
      <div>Loading</div>
      <div id="countdown">10</div>
    </div>

    <div id="infoImage">
      <img src="path_to_your_image.jpg" alt="Info Image">
    </div>

    <div id="endImage">
      <img src="path_to_your_image.jpg" alt="End Image">
    </div>

    <button id="infoButton">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V11H13V17ZM13 9H11V7H13V9Z" fill="white"/>
      </svg>
    </button>

    <!-- MindAR + A-Frame tracking -->
    <a-scene mindar-image="imageTargetSrc: data/targets.mind; filterMinCF:0.0005; filterBeta: .1;" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false">
      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!--TARGET 1-->
      <a-entity mindar-image-target="targetIndex: 0">
        <a-video id="video1Element" src="#video1" width="1" height="1" position="0 0 0" rotation="0 0 0" autoplay="false" sound="volume: 1"></a-video>
      </a-entity>

      <!--TARGET 2-->
      <a-entity mindar-image-target="targetIndex: 1">
        <a-video id="video2Element" src="#video2" width="1" height="0.5625" position="0 0 0" rotation="0 0 0" autoplay="false" sound="volume: 1"></a-video>
      </a-entity>

    </a-scene>

    <!-- VIDEO OUTPUT -->
    <video id="video1" src="data/video1.mp4" style="display:none;"></video>
    <video id="video2" src="data/video2.mp4" style="display:none;"></video>

    <script>
      // Countdown logic
      let countdownValue = 10;
      const countdownElement = document.getElementById('countdown');
      const loadingScreen = document.getElementById('loadingScreen');
      const endImage = document.getElementById('endImage');

      const countdownInterval = setInterval(() => {
        countdownElement.textContent = countdownValue;
        countdownValue--;
        if (countdownValue < 0) {
          clearInterval(countdownInterval);
          loadingScreen.style.display = 'none';
          endImage.style.display = 'flex';
        }
      }, 1000); // 10 seconds countdown

      endImage.addEventListener('click', () => {
        endImage.style.display = 'none';
      });

      document.getElementById('infoButton').addEventListener('click', () => {
        const infoImage = document.getElementById('infoImage');
        if (infoImage.style.display === 'flex') {
          infoImage.style.display = 'none';
        } else {
          infoImage.style.display = 'flex';
        }
      });

      const targetMap = ['video1', 'video2'];

      const setRecognizedTarget = (index, action) => {
        const videoElement = document.getElementById(targetMap[index]);
        const aframeVideoElement = document.getElementById(`${targetMap[index]}Element`);
        if (action === 'found') {
          videoElement.currentTime = 0;  // Reset the video to start
          videoElement.play();
          aframeVideoElement.setAttribute('src', `#${targetMap[index]}`);
        } else if (action === 'lost') {
          videoElement.pause();
          videoElement.currentTime = 0;
          aframeVideoElement.setAttribute('src', '');
        }
      };

      [0, 1].forEach(index => {
        const targetEntity = document.querySelector(`[mindar-image-target="targetIndex: ${index}"]`);
        targetEntity.addEventListener('targetFound', () => setRecognizedTarget(index, 'found'));
        targetEntity.addEventListener('targetLost', () => setRecognizedTarget(index, 'lost'));
      });

      document.querySelectorAll('a-video').forEach(video => {
        video.addEventListener('click', () => {
          const videoElement = document.getElementById(video.getAttribute('src').substring(1));
          videoElement.muted = !videoElement.muted;
        });
      });
    </script>
  </body>
</html>